--- SConstruct.orig	2022-05-28 21:05:14.000000000 -0500
+++ SConstruct	2022-05-28 23:48:23.000000000 -0500
@@ -140,7 +140,7 @@
     EnumVariable('MSVC_VERSION',
                  "Visual C++ to use for building (E.g. 11.0, 9.0)",
                  None,
-                 allowed_values=('14.0', '12.0',
+                 allowed_values=('14.2', '14.1', '14.0', '12.0',
                                  '11.0', '10.0', '9.0', '8.0', '6.0')
                 ),
 
@@ -207,7 +207,7 @@
 
 thisdir = os.getcwd()
 libdir = '$LIBDIR'
-incdir = '$PREFIX/include/serf-$MAJOR'
+incdir = '$LIBDIR/include/serf-$MAJOR'
 
 # This version string is used in the dynamic library name, and for Mac OS X also
 # for the current_version and compatibility_version options in the .dylib
@@ -322,7 +322,7 @@
     env.Append(LIBPATH=['$APR/LibR','$APU/LibR'],
                CPPPATH=['$APR/include', '$APU/include'])
   else:
-    env.Append(LIBPATH=['$APR/Release','$APU/Release'],
+    env.Append(LIBPATH=['$APR/lib','$APU/lib'],
                CPPPATH=['$APR/include', '$APU/include'])
 
   # zlib
@@ -335,7 +335,7 @@
                LIBPATH=['$ZLIB'])
 
   # openssl
-  env.Append(LIBS=['libeay32.lib', 'ssleay32.lib'])
+  env.Append(LIBS=['libcrypto.lib', 'libssl.lib'])
   if not env.get('SOURCE_LAYOUT', None):
     env.Append(CPPPATH=['$OPENSSL/include/openssl'],
                LIBPATH=['$OPENSSL/lib'])
@@ -344,7 +344,7 @@
                LIBPATH=['$OPENSSL/out32'])
   else:
     env.Append(CPPPATH=['$OPENSSL/inc32'],
-               LIBPATH=['$OPENSSL/out32dll'])
+               LIBPATH=['$OPENSSL'])
 else:
   if os.path.isdir(apr):
     apr = os.path.join(apr, 'bin', 'apr-1-config')
